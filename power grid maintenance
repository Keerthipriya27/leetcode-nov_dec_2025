class Solution:
    def processQueries(self, c: int, connections: List[List[int]], queries: List[List[int]]) -> List[int]:
        import heapq
        parent = list(range(c + 1))
        def find(x):
            if parent[x] != x:
                parent[x] = find(parent[x])
            return parent[x]
        def union(x, y):
            px, py = find(x), find(y)
            if px != py:
                parent[px] = py
        for u, v in connections:
            union(u, v)
        component_heaps = {}
        for station in range(1, c + 1):
            root = find(station)
            if root not in component_heaps:
                component_heaps[root] = []
            heapq.heappush(component_heaps[root], station)
        online = set(range(1, c + 1))
        result = []
        for query in queries:
            query_type, x = query
            if query_type == 1:
                root = find(x)
                if x in online:
                    result.append(x)
                else:
                    heap = component_heaps[root]
                    while heap and heap[0] not in online:
                        heapq.heappop(heap)
                    if heap:
                        result.append(heap[0])
                    else:
                        result.append(-1)
            else:
                online.discard(x)
        return result
