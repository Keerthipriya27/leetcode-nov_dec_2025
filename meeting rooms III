class Solution:
    def mostBooked(self, n: int, meetings):
        meetings.sort()
        available_rooms = list(range(n))
        import heapq
        heapq.heapify(available_rooms)
        busy_rooms = []
        meeting_count = [0] * n
        for start, end in meetings:
            while busy_rooms and busy_rooms[0][0] <= start:
                finish, room = heapq.heappop(busy_rooms)
                heapq.heappush(available_rooms, room)         
            if available_rooms:
                room = heapq.heappop(available_rooms)
                actual_end = end
            else:
                earliest_end, room = heapq.heappop(busy_rooms)
                duration = end - start
                start = earliest_end
                actual_end = start + duration          
            heapq.heappush(busy_rooms, (actual_end, room))
            meeting_count[room] += 1
        max_meetings = max(meeting_count)
        return meeting_count.index(max_meetings)
